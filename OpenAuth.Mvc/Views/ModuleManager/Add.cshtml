@model OpenAuth.Domain.Module
@{
    ViewBag.Title = "Module编辑界面";
    Layout = null;
}

<div class="bjui-pageContent">
    <form action="/ModuleManager/Add" class="pageForm" data-toggle="validate">
        <table class="table table-condensed table-hover">
            <tbody>
                <tr>
                    <td align="center"><h3>* 添加</h3></td>
                </tr>
                <tr>
                    <td>
                        @Html.HiddenFor(m => m.Id)
                <tr>
                    <td>

                        <label for="CascadeId" class="control-label x90">节点语义ID：</label>
                        <input type="text" name="CascadeId" id="CascadeId" value="@Model.CascadeId"
                               data-rule="required" size="20">
                    </td>
                </tr>
                <tr>
                    <td>

                        <label for="Name" class="control-label x90">功能模块名称：</label>
                        <input type="text" name="Name" id="Name" value="@Model.Name"
                               data-rule="required" size="20">
                    </td>
                </tr>
                <tr>
                    <td>

                        <label for="Url" class="control-label x90">主页面URL：</label>
                        <input type="text" name="Url" id="Url" value="@Model.Url"
                               data-rule="required" size="20">
                    </td>
                </tr>
                <tr>
                    <td>

                        <label for="HotKey" class="control-label x90">热键：</label>
                        <input type="text" name="HotKey" id="HotKey" value="@Model.HotKey"
                               data-rule="required" size="20">
                    </td>
                </tr>
                <tr>
                    <td>

                <tr>
                    <td>
                        <label for="ParentId" class="control-label x85">父节点流水号：</label>

                        <select name="ParentId" id="ParentId" data-toggle="selectpicker" data-rule="required">
                            <option value="0" @if (Model.ParentId == 0) { <text> selected="selected" </text>   }>默认</option>
                            <option value="1" @if (Model.ParentId == 1) { <text> selected="selected" </text>   }>状态1</option>
                        </select>
                    </td>
                </tr>
                <tr>
                    <td>

                <tr>
                    <td>
                        <label for="IsLeaf" class="control-label x85">是否叶子节点：</label>

                        <select name="IsLeaf" id="IsLeaf" data-toggle="selectpicker" data-rule="required">
                            <option value="0" @if (Model.IsLeaf) { <text> selected="selected" </text>   }>否</option>
                            <option value="1" @if (!Model.IsLeaf) { <text> selected="selected" </text>   }>是</option>
                        </select>
                    </td>
                </tr>
                <tr>
                    <td>

                <tr>
                    <td>
                        <label for="IsAutoExpand" class="control-label x85">是否自动展开：</label>

                        <select name="IsAutoExpand" id="IsAutoExpand" data-toggle="selectpicker" data-rule="required">
                            <option value="0" @if (Model.IsAutoExpand) { <text> selected="selected" </text>   }>否</option>
                            <option value="1" @if (!Model.IsAutoExpand) { <text> selected="selected" </text>   }>是</option>
                        </select>
                    </td>
                </tr>
                <tr>
                    <td>

                        <label for="IconName" class="control-label x90">节点图标文件名称：</label>
                        <input type="text" name="IconName" id="IconName" value="@Model.IconName"
                               data-rule="required" size="20">
                    </td>
                </tr>
                <tr>
                    <td>

                <tr>
                    <td>
                        <label for="Status" class="control-label x85">当前状态：</label>

                        <select name="Status" id="Status" data-toggle="selectpicker" data-rule="required">
                            <option value="0" @if (Model.Status == 0) { <text> selected="selected" </text>   }>默认</option>
                            <option value="1" @if (Model.Status == 1) { <text> selected="selected" </text>   }>状态1</option>
                        </select>
                    </td>
                </tr>
                <tr>
                    <td>

                        <label for="ParentName" class="control-label x90">父节点名称：</label>
                        <input type="text" name="ParentName" id="ParentName" value="@Model.ParentName"
                               data-rule="required" size="20">
                    </td>
                </tr>
                <tr>
                    <td>

                        <label for="Vector" class="control-label x90">矢量图标：</label>
                        <input type="text" name="Vector" id="Vector" value="@Model.Vector"
                               data-rule="required" size="20">
                    </td>
                </tr>
                <tr>
                    <td>

                <tr>
                    <td>
                        <label for="SortNo" class="control-label x85">排序号：</label>

                        <select name="SortNo" id="SortNo" data-toggle="selectpicker" data-rule="required">
                            <option value="0" @if (Model.SortNo == 0) { <text> selected="selected" </text>   }>默认</option>
                            <option value="1" @if (Model.SortNo == 1) { <text> selected="selected" </text>   }>状态1</option>
                        </select>
                    </td>
                </tr>
            </tbody>
        </table>
    </form>
</div>
<div class="bjui-pageFooter">
    <ul>
        <li><button type="button" class="btn-close">关闭</button></li>
        <li><button type="submit" class="btn-green">保存</button></li>
    </ul>
</div>

<script type="text/javascript">
    $(document).ready(function () {
        Init();
    });
    function Init() {
        var setting = {
            view: {
                selectedMulti: false
            },
            check: {
                enable: true,
                chkStyle: "checkbox",
                chkboxType: { "Y": "", "N": "" } //去掉勾选时级联
            },
            data: {
                key: {
                    name: 'Name',
                    title: 'Name'
                },
                simpleData: {
                    enable: true,
                    idKey: 'Id',
                    pIdKey: 'ParentId',
                    rootPId: 'null'
                }
            },
            callback: {
                onClick: zTreeOnClick,
                onCheck: zTreeCheck
            }
        };
        $.getJSON('OrgManager/LoadOrg', function (json) {
            var zTreeObj = $.fn.zTree.init($('#j_select_tree1'), setting, json);
            zTreeObj.expandAll(true);
        });
    }

    function zTreeCheck(e, treeId, treeNode) {
        var zTree = $.fn.zTree.getZTreeObj(treeId),
            nodes = zTree.getCheckedNodes(true);
        var ids = '', names = '';
        for (var i = 0; i < nodes.length; i++) {
            ids += ',' + nodes[i].Id;
            names += ',' + nodes[i].Name;
        }
        if (ids.length > 0) {  //去掉第一个逗号
            ids = ids.substr(1);
            names = names.substr(1);
        }

        var $from = $('#' + treeId).data('fromObj');
        if ($from && $from.length) $from.val(names);

        $('#OrganizationIds').val(ids);
    }
    function zTreeOnClick(event, treeId, treeNode) {
        var zTree = $.fn.zTree.getZTreeObj(treeId);
        zTree.checkNode(treeNode, !treeNode.checked, true, true);
        event.preventDefault();
    }
</script>